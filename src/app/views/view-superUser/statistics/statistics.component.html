<div class="row" *ngIf="loading === false">
    <div class="col-md-4">
        <button class="btn m-3" (click)="goBack()">
            <i class="fa-solid fa-angle-left" style="font-size: 35px;"></i>
        </button>
    </div>
    <div class="col-md-4">
        <h1 class="text-center my-4">Estadisticas globales</h1>
    </div>
    <div class="col-md-4">
    </div>
    <div class="col-1 col-md-1"></div>
    <div class="col-10 col-md-10 mt-4">
        <div class="row">
            <div class="col-6 col-md-1"></div>
            <div class="col-md-2  text-center">
                <button class="btnLabel" id="nBots">{{NbotsContainers}}</button>
                <br>
                <label class="mt-2" for="nBots">Numero de bots</label>
            </div>
            <div class="col-6 col-md-2  text-center">
                <button class="btnLabel" id="nActts">{{allActs}}</button>
                <br>
                <label class="mt-2" for="nActts">Numero de cuentas</label>
            </div>
            <div class="col-6 col-md-2  text-center">
                <button class="btnLabel" id="nActtsFree">{{allActsFree}}</button>
                <br>
                <label class="mt-2" for="nActtsFree">Numero de cuentas libres</label>
            </div>
            <div class="col-6 col-md-2  text-center">
                <button class="btnLabel" id="nProxy">{{allproxys}}</button>
                <br>
                <label class="mt-2" for="nProxy">Numero de proxys</label>
            </div>
            <div class="col-6 col-md-2  text-center">
                <button class="btnLabel" id="nProxyFree">{{allproxysFree}}</button>
                <br>
                <label class="mt-2" for="nProxyFree">Numero de proxys libres</label>
            </div>
            <div class="col-md-1"></div>
        </div>
    </div>
    <div class="col-1 col-md-1"></div>
    <div class="col-1 col-md-1"></div>
    <div class="col-10 col-md-10 text-center mt-5">
      <div class="btn-group btn-group-lg" role="group" aria-label="Large button group">
        <div class="row text-center">
          <button type="button" (click)="dataModal('Compañias')" data-bs-toggle="modal" data-bs-target="#dataModal" class="btnTable col-12 col-sm-6 col-md-4 btn btn-outline-dark">
            <div>
              <h3 id="dataC">{{dataComp.length}}</h3>
              <label for="dataC">Compañias</label>
            </div>
          </button>
          <button type="button" (click)="dataModal('Licencias')" data-bs-toggle="modal" data-bs-target="#dataModal" class="btnTable col-12 col-sm-6 col-md-4 btn btn-outline-dark">
            <div>
              <h3 id="dataC">{{datalicences.length}}</h3>
              <label for="dataC">Licencias</label>
            </div>
          </button>
          <button type="button" (click)="dataModal('Plataformas')" data-bs-toggle="modal" data-bs-target="#dataModal" class="btnTable col-12 col-sm-6 col-md-4 btn btn-outline-dark">
            <div>
              <h3 id="dataC">{{dataPlatforms.length}}</h3>
              <label for="dataC">Plataformas</label>
            </div>
          </button>
          <button type="button" (click)="dataModal('Modelos')" data-bs-toggle="modal" data-bs-target="#dataModal" class="btnTable col-12 col-sm-6 col-md-4 btn btn-outline-dark">
            <div>
              <h3 id="dataC">{{dataModels.length}}</h3>
              <label for="dataC">Modelos</label>
            </div>
          </button>
          <button type="button" (click)="dataModal('Usuarios')" data-bs-toggle="modal" data-bs-target="#dataModal" class="btnTable col-12 col-sm-6 col-md-4 btn btn-outline-dark">
            <div>
              <h3 id="dataC">{{dataU.length}}</h3>
              <label for="dataC">Usuarios</label>
            </div>
          </button>
          <button type="button" (click)="dataModal('Usuarios administradores')" data-bs-toggle="modal" data-bs-target="#dataModal" class="btnTable col-12 col-sm-6 col-md-4 btn btn-outline-dark">
            <div>
              <h3 id="dataC">{{dataUa.length}}</h3>
              <label for="dataC">Usuarios<br>administradores</label>
            </div>
          </button>
        </div>
      </div>
      <div class="row">
        <h2 class="my-4">Ultimos accesos</h2>
        <div class="col-md-6 col-12 mt-3">
          <h4>Usuario</h4>
          <table class="table">
              <thead class="table-success">
              <tr>
                <th scope="col">Fecha</th>
                <th scope="col">Usuario</th>
                <th scope="col">Compañia</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of dataAccessLog | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: pD, totalItems: dataAccessLog.length}">
                <td>{{item.loginDate | date: 'dd/MM/yyyy hh:mm a' }}</td>
                <td>{{item.user}}</td>
                <td>{{item.User_idUser.company_idCompany.nameCompany}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="pD = $event"></pagination-controls>
          </div>
        </div>
        <div class="col-md-6 col-12 mt-3">
          <h4>Usuarios administradores</h4>
          <table class="table">
              <thead class="table-success">
              <tr>
                <th scope="col">Fecha</th>
                <th scope="col">Usuario</th>
                <th scope="col">Compañia</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of dataAccessLogAdmin | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: pD, totalItems: dataAccessLogAdmin.length}">
                <td>{{item.loginDate | date: 'dd/MM/yyyy hh:mm a' }}</td>
                <td>{{item.user}}</td>
                <td>{{item.UserAdmin_idUserAdmin.company_idCompany.nameCompany}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="pD = $event"></pagination-controls>
          </div>
        </div>
      </div>
      <div class="row">
        <h2 class="my-4">Accesos invalidos</h2>
        <div class="col-md-6 col-12 mt-3">
          <h4>Usuario</h4>
          <table class="table">
              <thead class="table-danger">
              <tr>
                <th scope="col">Fecha</th>
                <th scope="col">Usuario</th>
                <th scope="col">Compañia</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of dataAccessLogFalse | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: pT, totalItems: dataAccessLogFalse.length}">
                <td>{{item.loginDate | date: 'dd/MM/yyyy hh:mm a' }}</td>
                <td>{{item.user}}</td>
                <td>{{item.User_idUser.company_idCompany.nameCompany}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="pT = $event"></pagination-controls>
          </div>
        </div>
        <div class="col-md-6 col-12 mt-3">
          <h4>Usuarios administradores</h4>
          <table class="table">
              <thead class="table-danger">
              <tr>
                <th scope="col">Fecha</th>
                <th scope="col">Usuario</th>
                <th scope="col">Compañia</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of dataAccessLogAdminFalse | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: pT, totalItems: dataAccessLogAdminFalse.length}">
                <td>{{item.loginDate | date: 'dd/MM/yyyy hh:mm a' }}</td>
                <td>{{item.user}}</td>
                <td>{{item.UserAdmin_idUserAdmin.company_idCompany.nameCompany}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="pT = $event"></pagination-controls>
          </div>
        </div>
      </div>
      <hr>
    </div>
    <div class="col-1 col-md-1"></div>
    <div class="col-1 col-md-1"></div>
    <div class="col-10 col-md-10 mt-5">
        <div class="text-center m-3">
            <h3>Contenedores de bots</h3>
        </div>
        <div>
            <div class="row row-cols-1 row-cols-md-3">
                <div class="col mb-4" *ngFor="let botContainer of botContainers">
                  <div class="card h-100 styleCard" (click)="getinfoBot(botContainer)" data-bs-toggle="modal" data-bs-target="#infoBotModal">
                    <div class="card-body">
                        <h5 class="card-title text-center">Bot con ip: <span style="font-weight: 600;">{{botContainer.ip}}</span></h5>
                        <div class="row mt-4">
                            <div class="col-6 col-md-6  text-center">
                                <button class="btnLabel" id="nActtsCards">{{botContainer.acctsLength}}</button>
                                <br>
                                <label class="mt-2" for="nActtsCards">Numero de cuentas</label>
                            </div>
                            <div class="col-6 col-md-6  text-center">
                                <button class="btnLabel" id="nProxyCards">{{botContainer.proxyLength}}</button>
                                <br>
                                <label class="mt-2" for="nProxyCards">Numero de proxys</label>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-1 col-md-1"></div>
</div>
  
<div class="row" *ngIf="loading === true">
    <div class="col-md-12 text-center mt-5">
        <div class="my-5">
            <h2>Cargando información</h2>
        </div>
        <div style="width: 45px; height: 45px;" class=" mx-1 spinner-grow text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <div style="width: 45px; height: 45px;" class=" mx-1 spinner-grow text-secondary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <div style="width: 45px; height: 45px;" class=" mx-1 spinner-grow text-success" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <div style="width: 45px; height: 45px;" class=" mx-1 spinner-grow text-danger" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <div style="width: 45px; height: 45px;" class=" mx-1 spinner-grow text-warning" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <div style="width: 45px; height: 45px;" class=" mx-1 spinner-grow text-info" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <div style="width: 45px; height: 45px;" class=" mx-1 spinner-grow text-dark" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="infoBotModal" tabindex="-1" aria-labelledby="infoBotModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" *ngIf="infoBot">
      <div class="modal-header">
        <h5 class="modal-title" id="infoBotModalLabel">IP: {{infoBot.ip}}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row">
            <div class="col-md-6">
                <h5>Numero de cuentas: <span>{{infoBot.acctsLength}}</span></h5>
            </div>
            <div class="col-md-6">
                <h5>Numero de cuentas libres: <span>{{infoBot.acctsFreeLength}}</span></h5>
            </div>
            <div class="col-md-6">
                <h5>Numero de proxys: <span>{{infoBot.proxyLength}}</span></h5>
            </div>
            <div class="col-md-6">
                <h5>Numero de proxys libres: <span>{{infoBot.proxyFreeLength}}</span></h5>
            </div>
            <div class="col-md-6">
                <h5>Cantidad de killbots: <span>{{infoBot.killbotsLength}}</span></h5>
            </div>
            <div class="col-md-6">
                <h5>Cantidad de logs: <span>{{infoBot.log.length}}</span></h5>
            </div>
        </div>
        <hr>
        <div class="text-center">
            <h4>Registros</h4>
        </div>
        <div class="text-center">
            <table class="table">
                <thead class="table-dark">
                  <tr>
                    <th scope="col">Fecha</th>
                    <th scope="col"># de bots</th>
                    <th scope="col">Modelo</th>
                    <th scope="col">Compañia</th>
                    <th scope="col">Usuario</th>
                    <th scope="col">Licencia</th>
                    <th scope="col">Plataforma</th>
                  </tr>
                </thead>
                <tbody *ngFor="let log of infoBot.log | paginate: {id: 'pageLic', itemsPerPage: 10, currentPage: p, totalItems: infoBot.log.length}">
                  <tr>
                    <td>{{ log.date | date: 'dd/MM/yyyy hh:mm a' }}</td>
                    <td>{{log.numberBots}}</td>
                    <td>{{log.name_model}}</td>
                    <td>{{log.userId.company_idCompany.nameCompany}}</td>
                    <td>{{log.userId.user}}</td>
                    <td>{{log.registerCompanyBotContainer.registerLicenses.licenses_idLicense.nameLicense}}</td>
                    <td>{{log.registerCompanyBotContainer.registerLicenses.licenses_idLicense.platform_idPlatform.namePlatform}}</td>
                  </tr>
                </tbody>
              </table>
              <div class="col-md-12 text-center" style="padding: 10px;">
                <pagination-controls id="pageLic" (pageChange)="p = $event"></pagination-controls>
              </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="dataModal" tabindex="-1" aria-labelledby="dataModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">{{modalTitle}}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <div *ngIf="dataComp && modalTitle ==='Compañias'">
          <table class="table">
            <thead>
              <tr class="text-center">
                <th scope="col">Compañia</th>
                <th scope="col">Tipo</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center" *ngFor="let data of dataComp.data | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: p, totalItems: dataComp.data.length}">
                <td>{{data.nameCompany}}</td>
                <td>{{data.typeCompany}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="p = $event"></pagination-controls>
          </div>
        </div>

        <div *ngIf="datalicences && modalTitle ==='Licencias'">
          <table class="table">
            <thead>
              <tr class="text-center">
                <th scope="col">Licencia</th>
                <th scope="col">Tipo</th>
                <th scope="col">Plataforma</th>
                <th scope="col"># de cuentas</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center" *ngFor="let data of datalicences.data | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: p, totalItems: datalicences.data.length}">
                <td>{{data.nameLicense}}</td>
                <td>{{data.type}}</td>
                <td>{{data.platform_idPlatform.namePlatform}}</td>
                <td>{{data.numberAccts}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="p = $event"></pagination-controls>
          </div>
        </div>

        <div *ngIf="dataPlatforms && modalTitle ==='Plataformas'">
          <table class="table">
            <thead>
              <tr class="text-center">
                <th scope="col">Plataforma</th>
                <th scope="col">Url</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center" *ngFor="let data of dataPlatforms.data | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: p, totalItems: dataPlatforms.data.length}">
                <td>{{data.namePlatform}}</td>
                <td>{{data.urlPlatform}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="p = $event"></pagination-controls>
          </div>
        </div>

        <div *ngIf="dataModels && modalTitle ==='Modelos'">
          <table class="table">
            <thead>
              <tr class="text-center">
                <th scope="col">Modelo</th>
                <th scope="col">Plataforma</th>
                <th scope="col">Compañia</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center" *ngFor="let data of dataModels.data | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: p, totalItems: dataModels.data.length}">
                <td>{{data.nickname}}</td>
                <td>{{data.platforms_idPlatform.namePlatform}}</td>
                <td>{{data.company_idCompany.nameCompany}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="p = $event"></pagination-controls>
          </div>
        </div>

        <div *ngIf="dataU && modalTitle ==='Usuarios'">
          <table class="table">
            <thead>
              <tr class="text-center">
                <th scope="col">Usuario</th>
                <th scope="col">Email</th>
                <th scope="col">Compañia</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center" *ngFor="let data of dataU.data | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: p, totalItems: dataU.data.length}">
                <td>{{data.user}}</td>
                <td>{{data.email}}</td>
                <td>{{data.company_idCompany.nameCompany}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="p = $event"></pagination-controls>
          </div>
        </div>

        <div *ngIf="dataUa && modalTitle ==='Usuarios administradores'">
          <table class="table">
            <thead>
              <tr class="text-center">
                <th scope="col">Usuario</th>
                <th scope="col">Email</th>
                <th scope="col">Compañia</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center" *ngFor="let data of dataUa.data | paginate: {id: 'pageLic', itemsPerPage: 15, currentPage: p, totalItems: dataUa.data.length}">
                <td>{{data.user}}</td>
                <td>{{data.email}}</td>
                <td>{{data.company_idCompany.nameCompany}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col-md-12 text-center" style="padding: 10px;">
            <pagination-controls id="pageLic" (pageChange)="p = $event"></pagination-controls>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>